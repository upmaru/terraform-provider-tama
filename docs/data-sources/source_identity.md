---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "tama_source_identity Data Source - tama"
subcategory: ""
description: |-
  Fetches information about a Tama Sensory Source Identity
---

# tama_source_identity (Data Source)

Fetches information about a Tama Sensory Source Identity

## Example Usage

```terraform
terraform {
  required_providers {
    tama = {
      source = "upmaru/tama"
    }
  }
}

# First, create a space to contain the specification
resource "tama_space" "example" {
  name = "example-space"
  type = "root"
}

# Create a specification
resource "tama_specification" "example" {
  space_id = tama_space.example.id
  version  = "1.0.0"
  endpoint = "https://api.example.com"
  schema = jsonencode({
    openapi = "3.0.3"
    info = {
      title       = "Example API"
      version     = "1.0.0"
      description = "Example API for source identity data source demonstration"
    }
    paths = {
      "/health" = {
        get = {
          summary = "Health check endpoint"
          responses = {
            "200" = {
              description = "API is healthy"
            }
          }
        }
      }
    }
  })
}

# Create a source identity
resource "tama_source_identity" "example" {
  specification_id = tama_specification.example.id
  identifier       = "ApiKey"
  api_key          = "example-api-key"

  validation {
    path   = "/health"
    method = "GET"
    codes  = [200]
  }
}

# Data source to fetch the created source identity
data "tama_source_identity" "example" {
  id = tama_source_identity.example.id
}

# Data source using a variable for the ID
variable "source_identity_id" {
  description = "ID of the source identity to fetch"
  type        = string
  default     = ""
}

data "tama_source_identity" "by_variable" {
  id = var.source_identity_id != "" ? var.source_identity_id : tama_source_identity.example.id
}

# Data source using an existing identity ID (when not managing the resource)
# This would be used when referencing an identity created outside of this configuration
data "tama_source_identity" "existing" {
  id = "existing-identity-id-here"
}

# Outputs to show the fetched data
output "fetched_identity" {
  description = "Complete information about the fetched source identity"
  value = {
    id               = data.tama_source_identity.example.id
    specification_id = data.tama_source_identity.example.specification_id
    identifier       = data.tama_source_identity.example.identifier
    provision_state  = data.tama_source_identity.example.provision_state
    current_state    = data.tama_source_identity.example.current_state
    validation = {
      path   = data.tama_source_identity.example.validation.path
      method = data.tama_source_identity.example.validation.method
      codes  = data.tama_source_identity.example.validation.codes
    }
  }
}

output "identity_validation_info" {
  description = "Validation configuration of the fetched identity"
  value = {
    path   = data.tama_source_identity.example.validation.path
    method = data.tama_source_identity.example.validation.method
    codes  = data.tama_source_identity.example.validation.codes
  }
}

output "identity_states" {
  description = "State information of the fetched identity"
  value = {
    provision_state = data.tama_source_identity.example.provision_state
    current_state   = data.tama_source_identity.example.current_state
  }
}

output "identity_basic_info" {
  description = "Basic information about the fetched identity"
  value = {
    id               = data.tama_source_identity.example.id
    specification_id = data.tama_source_identity.example.specification_id
    identifier       = data.tama_source_identity.example.identifier
  }
}

# Example using the data source to reference in other resources
# This could be useful when you need to reference an identity in other configurations
output "identity_reference" {
  description = "Reference information for use in other resources"
  value = {
    identity_id      = data.tama_source_identity.example.id
    specification_id = data.tama_source_identity.example.specification_id
    is_active        = data.tama_source_identity.example.provision_state == "active"
  }
}

# Example showing how to use the data source with conditionals
locals {
  identity_is_ready = (
    data.tama_source_identity.example.provision_state == "active" &&
    data.tama_source_identity.example.current_state == "completed"
  )
}

output "identity_readiness" {
  description = "Whether the identity is ready for use"
  value = {
    is_ready        = local.identity_is_ready
    provision_state = data.tama_source_identity.example.provision_state
    current_state   = data.tama_source_identity.example.current_state
  }
}

# Example showing validation configuration details
output "validation_details" {
  description = "Detailed validation configuration"
  value = {
    endpoint      = "${data.tama_source_identity.example.validation.method} ${data.tama_source_identity.example.validation.path}"
    success_codes = data.tama_source_identity.example.validation.codes
    codes_count   = length(data.tama_source_identity.example.validation.codes)
    primary_code  = data.tama_source_identity.example.validation.codes[0]
  }
}

# Example of using multiple data sources
data "tama_source_identity" "by_variable_lookup" {
  id = data.tama_source_identity.example.id
}

output "cross_reference_check" {
  description = "Verify data consistency across multiple data source calls"
  value = {
    ids_match = data.tama_source_identity.example.id == data.tama_source_identity.by_variable_lookup.id
    states_match = (
      data.tama_source_identity.example.provision_state == data.tama_source_identity.by_variable_lookup.provision_state &&
      data.tama_source_identity.example.current_state == data.tama_source_identity.by_variable_lookup.current_state
    )
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `id` (String) Identity identifier

### Read-Only

- `current_state` (String) Current state of the identity
- `identifier` (String) Identifier for the identity
- `provision_state` (String) Current provision state of the identity
- `specification_id` (String) ID of the specification this identity belongs to
- `validation` (Block, Read-only) Validation configuration for the identity (see [below for nested schema](#nestedblock--validation))

<a id="nestedblock--validation"></a>
### Nested Schema for `validation`

Read-Only:

- `codes` (List of Number) List of acceptable HTTP status codes
- `method` (String) HTTP method for validation
- `path` (String) Validation endpoint path
